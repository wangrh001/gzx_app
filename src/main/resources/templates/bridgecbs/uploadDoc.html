<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>

    <meta charset="utf-8"/>
    <title>Bootstrap 实例 - 模态框（Modal）插件</title>
    <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css"/>
    <link rel="stylesheet" th:href="@{/css/table.css}"/>
    <script src="https://cdn.bootcss.com/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script th:inline="javascript">


        function openFile() {
            console.log('enter the openFile')
            document.getElementById("files").click();
        }

        function uploadFileByType(typeId) {
            console.log('enter the uploadFileByType')
            /*<![CDATA[*/
            var form = document.getElementById(typeId);
            console.log('form==='+form)
            var orderId = document.getElementById("orderId").value
            console.log('orderId==='+orderId)
            form.action="/doc/uploadTypeFile?typeId="+typeId+"&orderId="+orderId
            form.submit();
            //这个符号不能删除！！！！
            // /*]]>*/
        }

        function AddButton() {
            /*<![CDATA[*/
            //生成进入该页面的所有button
            var files = [[${typeFiles}]];
            var table = document.createElement("table")
            if(files){
                var fileJson = JSON.parse(files)
                for(var p in fileJson){
                    var chName = fileJson[p].chName;
                    var fileDesc = fileJson[p].fileDesc;
                    var typeId = fileJson[p].typeId;

                    var row = table.insertRow();

                    var fileName = row.insertCell()
                    fileName.innerHTML=chName

                    var fileDescField = row.insertCell()
                    fileDescField.innerHTML=fileDesc

                    var fileForm =document.createElement("form")
                    fileForm.id=typeId;
                    fileForm.method='post';
                    fileForm.enctype='multipart/form-data';
                    //fileForm.style = 'float:center;';

                    var button = row.insertCell()
                    button.innerHTML="<input id = 'files' form="+typeId+" class='fileinput' name='files' type='file' multiple='true'/><button type='submit'  onclick='uploadFileByType("+typeId+")'>确定上传</button>";

                    fileForm.appendChild(button)

                    row.appendChild(fileForm)
                    row.appendChild(button)
                    table.appendChild(row)
                }
            }
            document.body.appendChild(table);
            console.log('enter end function----')
            //这个符号不能删除！！！！
            // /*]]>*/
        }
    </script>
</head>
<body class="container" onload="AddButton()">

<form class="form-horizontal" method="post" id="order_form" enctype="multipart/form-data" th:action="@{/bridgecbs/bridgeOrder/toModify(id=${orderId})}">
    <input type="hidden" id="orderId" th:value="*{orderId}"/>
    <div class="row">
        <div class="col-md-12 " id="filesDiv">
            <!--图片放大 模态框（Modal） -->
            <div class="modal fade text-center" id="imgZoomInModal" tabindex="-1" role="dialog"
                 aria-labelledby="myModalLabel" aria-hidden="true">
                <div class="modal-dialog" style="display: inline-block; width: auto;">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true"> &times;
                            </button>
                        </div>
                        <div class="modal-body">
                            <img src="" id="pigImg"/>
                        </div>
                    </div>
                    <!-- /.modal-content -->
                </div>
                <!-- /.modal -->
            </div>
        </div>
    </div>
    <div>
        <input type="submit" value="返回上页" class="btn btn-info"/>
    </div>
</form>
</body>
<script type="text/javascript">
    //点击查看原图
    function imgZoomIn(src) {
        $("#pigImg").attr('src', src);
        $("#imgZoomInModal").modal("show");
    }
</script>
</html>